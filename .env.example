# =============================================================================
# Memorly Docker Compose Environment Configuration
# =============================================================================
# Copy this file to .env and fill in your API keys and configuration
# Usage: cp .env.example .env

# =============================================================================
# API Keys
# =============================================================================

# Gemini API Key (for extract-features-service)
# Get your key from: https://aistudio.google.com/app/apikey
GEMINI_API_KEY=your-gemini-api-key-here

# DeepInfra API Key (for embed-service CLIP embeddings & video-segmentation-service Whisper)
# Get your key from: https://deepinfra.com/dash/api_keys
# Used by:
#   - embed-service: CLIP embeddings for images, text, and videos
#   - video-segmentation-service: Whisper audio transcription
DEEPINFRA_API_KEY=your-deepinfra-api-key-here

# DeepInfra Base URL (OpenAI-compatible endpoint)
# Used by embed-service and video-segmentation-service
OPENAI_API_KEY=${DEEPINFRA_API_KEY}
OPENAI_BASE_URL=https://api.deepinfra.com/v1/openai

# =============================================================================
# Database Configuration
# =============================================================================

# MongoDB Configuration
MONGO_URI=mongodb://mongodb:27017/
MONGO_DB_NAME=memorly

# Milvus Configuration (running on separate network)
# Update these to match your Milvus instance
MILVUS_HOST=host.docker.internal
MILVUS_PORT=19530

# =============================================================================
# Gateway Service Configuration
# =============================================================================

# Face Similarity Threshold (0.0 to 1.0)
# Higher = stricter matching, Lower = looser matching
FACE_SIMILARITY_THRESHOLD=0.4

# Video Embedding Fusion Weights
# Should sum to 1.0
VIDEO_VISUAL_WEIGHT=0.6
VIDEO_TEXT_WEIGHT=0.4

# File Upload Limits
MAX_UPLOAD_SIZE=100000000

# =============================================================================
# Service Configuration
# =============================================================================

# Logging Level (DEBUG, INFO, WARNING, ERROR)
LOG_LEVEL=INFO

# Service Ports (internal)
# These are the ports inside the Docker network
# External ports are defined in docker-compose.yml
EXTRACT_FEATURES_PORT=8000
FACE_EXTRACTION_PORT=8000
EMBED_SERVICE_PORT=8000
UPSERT_SERVICE_PORT=8000
VIDEO_SEGMENTATION_PORT=8000
GATEWAY_SERVICE_PORT=8000

# =============================================================================
# Optional: Advanced Configuration
# =============================================================================

# Embedding Model (for embed-service)
EMBEDDING_MODEL=sentence-transformers/clip-ViT-B-32-multilingual-v1

# Scene Detection Threshold (for video-segmentation-service)
SCENE_THRESHOLD=0.3

# Video Processing Language (for Whisper transcription)
VIDEO_LANGUAGE=en

# =============================================================================
# Notes
# =============================================================================
# 1. DO NOT commit the .env file to version control
# 2. API Key Setup:
#    - GEMINI_API_KEY: Required for image feature extraction
#    - DEEPINFRA_API_KEY: Required for CLIP embeddings and Whisper transcription
#    - OPENAI_API_KEY is automatically set to DEEPINFRA_API_KEY
# 3. Milvus should be running separately on your host or accessible network
# 4. MongoDB will be started automatically by docker-compose
# 5. Both embed-service and video-segmentation-service use DeepInfra's OpenAI-compatible API
